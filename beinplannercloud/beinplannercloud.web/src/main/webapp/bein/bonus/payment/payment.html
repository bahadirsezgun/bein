<div class="row" ng-controller="BonusPaymentController as bpc"
	ng-init="init()">


	<section class="ptboss-container-small {{filterClass}}"
		ng-show="filter">
		<div class="hpanel">
			<div class="panel-body">
				<div class="m-b-md text-center">
					<h4>{{'bonusFilter'|translate}}</h4>
					<small> {{'bonusFilterComment'|translate}} </small>
				</div>

				
				
				
				<div class="form-group">
					<label class="control-label">{{'progType'|translate}}*</label> 
					<select class="form-control"  ng-model="bonusPayment.bonType">
					  		<option value="0">{{'pleaseSelect'|translate}}</option>
					  		<option value="bpp">{{'personal_program'|translate}}</option>
					  		<option value="bpc">{{'class_program'|translate}}</option>
					</select>
				</div>
				
				<div class="form-group">
					<label class="control-label">{{'instructor'|translate}}*</label> 
					<select class="form-control" ng-model="staffId" >
						<option value="0">{{'pleaseSelect'|translate}}</option>
						<option ng-repeat="staff in staffs" value="{{staff.userId}}">
													{{staff.userName +' '+staff.userSurname}}</option>
						
						
					</select>
					

				</div>
				<div class="form-group">
					<div class="checkbox">
						<input type="checkbox" class="i-checks" id="inQueryCheck" checked
							ng-click="singleClassCheck()"> {{'monthly' | translate}}
						<p class="help-block small">{{'monthlyBonusHint' | translate}}</p>
					</div>
				</div>


				<div class="form-group" ng-show="monthly">
					<label class="control-label">{{'year'|translate}}*</label> <select
						class="form-control " ng-model="year"
						ng-options="y as y for y in years">
						<option ng-value="">{{'pleaseSelect'|translate}}</option>
					</select>

				</div>
				<div class="form-group" ng-show="monthly">
					<label class=" control-label">{{'month'|translate}}*</label> <select
						class="form-control " ng-model="month"
						ng-options="m.value as m.name for m in months">
						<option ng-value="">{{'pleaseSelect'|translate}}</option>
					</select>

				</div>




				<div class="form-group" ng-show="!monthly">
					<label class="control-label">{{'startDate'|translate}}</label>
					<div class="input-group date">
						<input type="text" class="form-control" id="startDate"
							ng-model="startDate"> <span class="input-group-addon"><i
							class="glyphicon glyphicon-calendar"></i></span>
					</div>
				</div>

				<div class="form-group" ng-show="!monthly">
					<label class="control-label">{{'endDate'|translate}}</label>
					<div class="input-group date">
						<input type="text" class="form-control" id="endDate"
							ng-model="endDate"> <span class="input-group-addon"><i
							class="glyphicon glyphicon-calendar"></i></span>
					</div>
				</div>



				<button class="btn btn-success btn-block"
					ng-click="queryBonusPayment()">{{'query'|translate}}</button>

			</div>

		</div>


	</section>
	<section ng-show="!filter">
		<div class="row">
			<div class="col-lg-12">
				<a ng-click="showFilter()" class="pull-right"><i
					class="pe-7s-close-circle fa-3x text-danger"></i> </a>
			</div>
		</div>
	</section>
	<section class="animated fadeInUp" ng-show="!filter">


		<section class="animated fadeInUp" ng-show="payment">
			<div class="row">
				<div class="col-sm-4">

					<div class="hpanel">
						<div class="panel-body">
							<div class="m-b-md text-center">
								<h4>{{'makePayment'|translate}}</h4>
								<small> {{'makePaymentComment'|translate}} </small>
							</div>
							<div class="form-group">
								<label class="control-label">{{'instructor'|translate}}*</label>
								<label class="text-success"> {{staff.userName+' '+staff.userSurname}}</label>
								
							</div>


							<div class="form-group">
								<label class="control-label">{{'startDate'|translate}}</label>
								<div class="input-group date">
									<input type="date" class="form-control" id="bonPaymentDate"
										ng-model="bonusPayment.bonPaymentDate"> <span
										class="input-group-addon"><i
										class="glyphicon glyphicon-calendar"></i></span>
								</div>
							</div>

							<div class="form-group">
								<label class="control-label">{{'payAmount'|translate}}</label>
								<div class="input-group date">
									<input type="text" class="form-control"
										ng-model="bonusPayment.bonAmount"> <span
										class="input-group-addon"><i
										class="glyphicon glyphicon-calendar"></i></span>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input type="checkbox" class="i-checks" id="inPaymentCheck"
										checked ng-click="singleClassCheck()"> {{'monthly' |
									translate}}
									<p class="help-block small">{{'monthlyBonusHint' |
										translate}}</p>
								</div>
							</div>
							<div class="form-group" ng-show="monthlyPayment">
								<label class="control-label">{{'year'|translate}}*</label> <select
									class="form-control " ng-model="bonusPayment.bonYear"
									ng-options="y as y for y in years"  disabled="disabled">
									<option ng-value="">{{'pleaseSelect'|translate}}</option>
								</select>

							</div>
							<div class="form-group" ng-show="monthlyPayment">
								<label class=" control-label">{{'month'|translate}}*</label> <select
									class="form-control " ng-model="bonusPayment.bonMonth"  disabled="disabled"
									ng-options="m.value as m.name for m in months">
									<option ng-value="">{{'pleaseSelect'|translate}}</option>
								</select>

							</div>
							<div class="form-group" ng-show="!monthlyPayment">
								<label class="control-label">{{'startDate'|translate}}</label>
								<div class="input-group date">
									<input type="date" class="form-control" id="bonStartDate"
										ng-model="bonusPayment.bonStartDate"  disabled="disabled"> <span
										class="input-group-addon" ><i
										class="glyphicon glyphicon-calendar"></i></span>
								</div>
							</div>

							<div class="form-group" ng-show="!monthlyPayment">
								<label class="control-label">{{'endDate'|translate}}</label>
								<div class="input-group date">
									<input type="date" class="form-control" id="bonEndDate"
										ng-model="bonusPayment.bonEndDate" disabled="disabled"> <span
										class="input-group-addon"><i
										class="glyphicon glyphicon-calendar"></i></span>
								</div>
							</div>
							<div class="form-group">
								<label class="control-label">{{'payComment'|translate}}</label>
								<textarea rows="5" class="form-control"
									ng-model="bonusPayment.bonComment"></textarea>

							</div>


							<button class="btn btn-success btn-block"
								ng-click="saveBonusPayment()">{{'save'|translate}}</button>

						</div>
					</div>

				</div>
				<div class="col-sm-3">
					<div class="row">

						<div class="col-sm-12">
							<div class="hpanel hbgyellow">
								<div class="panel-body">
									<div class="text-center">
										<h3>{{'willPayBonus'|translate}}</h3>
										<p class="text-medium  font-light">
											{{(userBonusObj.willPayAmount|number:2)+" "+ptCurrency}}</p>
										<small> {{userBonusObj.monthName}} </small>
									</div>
								</div>
							</div>
						</div>
						<div class="col-sm-12">
							<div class="hpanel hbgblue">
								<div class="panel-body">
									<div class="text-center">
										<h3>{{'totalBonusPayment'|translate}}</h3>
										<p class="text-medium  font-light">{{(payedAmount|number:2)+"
											"+ptCurrency}}</p>
										<small> {{userBonusObj.monthName}} </small>
									</div>
								</div>
							</div>
						</div>
						<div class="col-sm-12">
							<div class="hpanel {{leftPaymentClass}}">
								<div class="panel-body">
									<div class="text-center">
										<h3>{{'leftPayment'|translate}}</h3>
										<p class="text-medium  font-light">{{(leftPayment|number:2)+"
											"+ptCurrency}}</p>
										<small> {{userBonusObj.monthName}} </small>
									</div>
								</div>
							</div>
						</div>

                   </div>
                   
                  </div> 
                   <div class="col-sm-5">
						<div class="col-sm-12">
							<div class="hpanel panel-group">
								<div class="panel-body">
									<table class="table table-stripped">
										<thead>
											<th width="10%">{{'payDate'|translate}}</th>
											<th width="10%">{{'payAmount'|translate}}</th>
											<th width="70%">{{'payComment'|translate}}</th>
											<th width="10%">{{'execution'|translate}}</th>
										</thead>
										<tbody>
											<tr ng-repeat="bonusPayment in bonusPayments">
												<td>{{bonusPayment.bonPaymentDate|date:dateFormat}}</td>
												<td>{{(bonusPayment.bonAmount|number:2)}}</td>
												<td>{{bonusPayment.bonComment}}</td>
												<td>
													
														<i class="pe-7s-trash text-danger fa-2x iBtn" ng-click="deleteBonusPayment(bonusPayment)"></i>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
							</div>
							<div class="col-sm-12 text-center">	
										<i class="pe-7s-search fa-4x " ng-click="searchBonusPayment()"></i><br />
										<h3 class="font-light">{{'detail'|translate}}</h3>
							 </div>
					</div>
				</div>
		</section>
		<section class="animated fadeInUp" data-ng-show="!payment">
			
			<div class="hpanel" ng-show="!paymentDetail">
				<div class="panel-heading hbuilt">
					<h3 class="pull-left">{{staff.userName+" "+staff.userSurname}}</h3>
					<div class="text-center m-b-md">
						<div class="contact-panel">
							<img alt="logo" class="img-circle m-b m-t-sm "
								ng-src="{{staff.profileUrl==null?(staff.userGender==1?'/homerlib/images/profile.png':'/homerlib/images/profilem.png'):(staff.urlType==1?'/bein/member/get/profile/'+staff.userId+'/1':'/homerlib/images/'+staff.profileUrl )   }}">
						</div>
					</div>
					 <a ng-click="showPayment()" class="pull-right"><i class="pe-7s-doubleup fa-3x text-danger"></i> </a>
				</div>
				<div class="panel-body">
					<div class="row">
						<div class="col-sm-12">
							<table class="table table-stripped">
								<thead>
									<th width="5%">{{'No'|translate}}</th>
									<th width="5%">{{'progCount'|translate}}</th>
									<th width="15%">{{'progName'|translate}}</th>
									<th width="10%">{{'classDate'|translate}}</th>
									<th width="10%">{{'unitPrice'|translate}}</th>
									<th width="10%">{{rateLabel}}</th>
									<th width="10%">{{'progressPayment'|translate}}</th>
									<th width="25%">{{'members'|translate}}</th>
									<th width="10%">{{'detail'|translate}}</th>
								</thead>
								<tbody>
									<tr
										ng-repeat="userBonusDetailObj in userBonusObj.userBonusDetailObjs">
										<td><small>{{userBonusDetailObj.classCount}}</small></td>
										<td><small>{{userBonusDetailObj.schCount}}</small></td>
										<td><small>{{userBonusDetailObj.progName}}</small></td>
										<td><small>{{userBonusDetailObj.planStartDate|date:dateTimeFormat}}</small></td>
										<td><small>{{(userBonusDetailObj.packetUnitPrice|number:2)+' '+ptCurrency}}</small></td>
										<td><small>{{userBonusDetailObj.bonusValue+' ('+rateSuffix+')'}}</small></td>
										<td><small>{{(userBonusDetailObj.staffPaymentAmount|number:2)
												+' '+ptCurrency}}</small></td>
										<td><small
											ng-repeat="scf in userBonusDetailObj.scheduleFactories">
												<code>{{scf.user.userName}} {{scf.user.userSurname}}</code>
										</small></td>
										<td>
											<button class="btn btn-xs btn-default"
												ng-click="editBonusDetail(userBonusDetailObj)">
												{{'detail'|translate}}</button>
										</td>
									</tr>
								</tbody>
							</table>

						</div>
					</div>
				</div>
			</div>


			<div ng-show="paymentDetail" >
			
			    <table class="table table-stripped">

					<tr ng-repeat="schf in scheduleFactories">
						<td>
							<div class="contact-panel text-center">
								<img alt="logo" class="img-circle m-b m-t-sm "
									ng-src="{{schf.user.profileUrl==null?(schf.user.userGender==1?'/homerlib/images/profile.png':'/homerlib/images/profilem.png'):(schf.user.urlType==1?'/bein/get/profile/'+schf.userId+'/1':'/homerlib/images/'+schf.user.profileUrl )   }}">
								<p>{{schf.user.userName+" "+schf.user.userSurname}}</p>
								<p>{{schf.user.userGsm}}</p>



							</div>
						</td>
						<td>
							<button
								class="btn btn-lg btn-circle {{schf.packetPaymentFactory.payConfirm==1?'btn-success':'btn-danger'}}"></button>
						</td>
						<td>

							<table class="table table-stripped text-center">
								<thead>
									<th width="10%" class="text-center">{{'packetPrice'|translate}}</th>
									<th width="10%" class="text-center">{{'payAmount'|translate}}</th>
									<th width="10%" class="text-center">{{'leftPayment'|translate}}</th>
									<th width="10%" class="text-center">{{'attentionCount'|translate}}</th>
									<th width="20%" class="text-center">{{'leftPaymentCalcComment'|translate}}</th>
									<th width="10%" class="text-center">{{rateLabel}}</th>
									<th width="10%" class="text-center" ng-if="schf.packetPaymentFactory.payType==2">{{'creditCardCommissionRate'|translate}}</th>
									<th width="10%" class="text-center">{{'progressPayment'|translate}}</th>
								</thead>
								<tbody>
									<tr>
										<td class="text-center"><small>{{schf.packetSaleFactory.packetPrice+" "+ptCurrency}}</small></td>
										
										<td class="text-center"><small>{{((schf.packetPaymentFactory!=null)?(schf.packetPaymentFactory.payAmount):'0')+" "+ptCurrency}}</small></td>
										
										
										<td class="text-center"><small>{{((schf.packetSaleFactory.packetPrice-schf.packetPaymentFactory.payAmount)|number:2)+" "+ptCurrency}}</small></td>
										<td class="text-center"><small>{{schf.saleCount}}</small></td>
										<td class="text-center" ng-if="schf.packetPaymentFactory!=null"><small>{{(((schf.packetPaymentFactory.payAmount)/schf.saleCount)|number:2)+" "+ptCurrency}}</small></td>
										<td class="text-center" ng-if="schf.packetPaymentFactory==null"><small>{{"0 "+ptCurrency}}</small></td>
										
										<td class="text-center"><small> {{(userBonusDetailObj.bonusValue)+'('+rateSuffix+')'}}</small></td>
										<td class="text-center" ng-if="schf.packetPaymentFactory.payType==2">
											<small ng-if="creditCardCommissionRule==1">
												{{(creditCardCommissionRate)+' ('+rateSuffix+')'}}
											</small>
										</td>
									
										
										<td class="text-center" ng-if="schf.packetPaymentFactory!=null"><small>{{(schf.unitPrice|number:2)+" "+ptCurrency}}</small></td>
										<td class="text-center" ng-if="schf.packetPaymentFactory==null"><small>{{"0.00 "+ptCurrency}}</small></td>
										
										
										
										
									</tr>
								</tbody>
							</table>
						</td>

						<td>
							<table class="table table-stripped">
								<thead>
									<th width="10%">{{'confirm'|translate}}</th>
									<th width="10%">{{'payDate'|translate}}</th>
									<th width="10%">{{'payAmount'|translate}}</th>
									<th width="70%">{{'payComment'|translate}}</th>
								</thead>
								<tbody>
									<tr
										ng-repeat="ppdf in schf.packetPaymentFactory.packetPaymentDetailFactories">
										<td><button
												class="btn btn-xs btn-circle {{ppdf.payConfirm==1?'btn-success':'btn-danger'}}"></button></td>
										<td><small>{{ppdf.payDateStr}}</small></td>
										<td><small>{{(ppdf.payAmount|number:2)+" "+ptCurrency}}</small></td>
										<td><small>{{ppdf.payComment}}</small></td>
									</tr>
								</tbody>
							</table>


						</td>


					</tr>
				</table>
			
			
			</div>



		</section>




	</section>

</div>
